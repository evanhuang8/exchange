<!DOCTYPE HTML>

<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>Bazaarboy</title>
	<script type="text/javascript">
		var rootUrl = '{% url exchange-home %}';
		var csrfToken = '{{ csrf_token }}';
		function isNumber(n) {
			return !isNaN(parseFloat(n)) && isFinite(n);
		}
		function shortenName(name) {
			var sName = name;
			var parts = name.split(' ');
			if (parts.length > 1) {
				sName = parts[0] + ' ' + parts[parts.length - 1].substring(0, 1) + '.';
			}
			return sName;
		}
	</script>

	<script type='text/javascript' src='http://code.jquery.com/jquery-1.8.3.min.js'></script>

	<style type='text/css'>
	body{
		margin: 0;
		padding: 0;
		background-color: #f8f5f0;
	}

	#container{
		width: 1020px;
		margin: 100px auto;
	}
	#container_left{
		float: left;
		width:460px;
		padding-right: 50px;
		border-right:#c69c6d 2px solid;
	}
	#container_right{
		width: 460px;
		float: left;
		text-align:center;
	}
	#right_logo{
		margin: 0 auto;
		margin-top: 50px;
	}
	#right_fblogin{
		margin: 60px auto;
		cursor: pointer;
		margin-bottom:30px;
	}
	#right_login{
		margin: 0 auto;
		width: 260px;
	}
	#right_login input{
		margin: 5px auto;
		padding: 5px;
		width: 250px;
		border: #C69C6D thin solid;
	}
	#right_login input[type=submit]{
		width:262px;
		cursor: pointer;
	}

	#right_register{
		display:none;
		margin: 0 auto;
		width: 260px;
	}
	#right_register input{
		margin: 5px auto;
		padding: 5px;
		width: 250px;
		border: #C69C6D thin solid;
	}
	#right_register input[type=submit]{
		width:262px;
		cursor: pointer;
	}
	
	#right_links{
		color: #c69c6d;
		margin: 50px auto;
		font-family: helvetica;
	}
	#right_links a{
		color: #c69c6d;
		text-decoration: none;
	}
	#right_links a:hover{
		color: #2a8074;
	}
	.clear{
		clear:both;
	}
	</style>
</head>
<script type="text/javascript" src="{{ STATIC_URL }}js/landing.js"></script>
<script type='text/javascript'>
$(document).ready(function() {
	fbLoginDispatch();
});

function fbLoginDispatch() {
	$('#right_fblogin').click(function() {
		var fbPermissions = '';
		FB.login(function(response) {
			if (response.authResponse) {
				var fbAccessToken = response.authResponse.accessToken;
				console.log(fbAccessToken);
				csrfToken = '{{ csrf_token }}';
				$.post('{{ STATIC_URL }}../fbAuth', {accessToken:fbAccessToken, csrfmiddlewaretoken:csrfToken}, function(fbAuthResponse) {
					console.log(fbAuthResponse);
					fbAuthResponse = jQuery.parseJSON(fbAuthResponse);
					if (fbAuthResponse.status == 'OK') {
						document.location.reload(true);
					} else {
						alert('FAIL: ' + fbAuthResponse.error);
					}
				});
			}
		}, {scope:fbPermissions});
	});
}
</script>

<body>

<div id="fb-root"></div>
<script>
// Initialization
window.fbAsyncInit = function() {
	FB.init({
		appId      : '368676003227090', // App ID
		channelUrl : '{{ STATIC_URL }}../channel.html', // Channel File
		status     : true, // check login status
		cookie     : true, // enable cookies to allow the server to access the session
		xfbml      : true  // parse XFBML
	});
	if (typeof window.fbSDKReady == 'function') {
		fbSDKReady();
	}
};
// Load the SDK Asynchronously
(function(d){
	var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
	if (d.getElementById(id)) {return;}
	js = d.createElement('script'); js.id = id; js.async = true;
	js.src = "//connect.facebook.net/en_US/all.js";
	ref.parentNode.insertBefore(js, ref);
}(document));
</script>

	<div id='container'>
		<div id='container_left'>
			<img src='{{ STATIC_URL }}images/illustartion.png' />
		</div>
		<div id='container_right'>
			<img id='right_logo' src='{{ STATIC_URL }}images/logo.png' />
			<img id='right_fblogin' src='{{ STATIC_URL }}images/Facbeooklogin.png' />
			<form id='right_login' name='login'>
				<input type='text' name='email' value='' />
				<input type='password' name='password' value='' />
				<input type='submit' name='login' value='Log In' />
			</form>
			<form id='right_register' name='register'>
				{% csrf_token %}
				<input type='text' name='email' value='' />
				<input type='password' name='password' value='' />
				<input type='password' name='confirm' value='' />
				<input type='submit' name='register' value='Register' />
			</form>
			<a href="javascript:;" id="right_switch">Register</a>
			<div id='right_links'>
				<a href='http://bazaarboy.tumblr.com/about'>ABOUT</a> | <a href='http://bazaarboy.tumblr.com/'>BLOG</a> | <a href='mailto:build@bazaarboy.com'>CONTACT</a>
			</div>
		</div>
		<div class="clear">&nbsp;</div>
	</div>
</body>

</html>
